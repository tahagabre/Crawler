<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>Crawler</title>
    <script src="lib/phaser.2.6.1.min.js" type="text/javascript"></script>
    <script src="lib/box2d-plugin-full.min.js" type="text/javascript"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>
    <!--<script src="app.js" type="text/javascript"></script> -->
    <script type="text/javascript">
var game = new Phaser.Game(800, 600, Phaser.AUTO, '', {
    preload: preload, 
    create: create, 
    update: update
});   

var player;

function preload() {
    game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
    game.scale.pageAlignHorizontally = true;
    game.scale.pageAlignVertically = true;
    game.stage.backgroundColor = '#eee';

    game.load.spritesheet('player', './assets/sheet_hero_idle.png', 64, 64);

    game.load.spritesheet('wall', './assets/roguelike-cave-pack/Spritesheet/roguelikeDungeon_transparent.png', 16, 16, margin = 1,);
}

function create() {

    //Player Controller
    //===========================
    //Enable Physics on the world
    game.physics.startSystem( Phaser.Physics.ARCADE );
    //Enable input
    game.inputEnabled = true;

    //Create instance of player
    //player = new Player("Wok");
    //wall = new Wall(100, 100);

    //Create sprite, animation and play
    player = game.add.sprite(game.world.centerX, game.world.centerY, 'player');
    
    //Set the center of the player as reference to position
    player.anchor.x = 0.5;
    player.anchor.y = 0.5;
    
    var idle = player.animations.add( 'idle' );
    player.animations.play('idle', 10, true);

    game.camera.follow( player );

    //Enable player's physics
    game.physics.arcade.enable(player);

    //Move player toward taps
    game.input.onDown.add( move, this );

    //Obstacle Controller
    //==============================

    //Create group for things that are unpassable
    obstacles = game.add.group();
    obstacles.enableBody = true;

    //create wall in obstacles group
    var wall = obstacles.create( 10, 10, 'wall' );
    wall.body.immovable = true;
}
    
function update() {
    var hitObstacle = game.physics.arcade.collide(player, obstacles); //needs to be tested
    if ( hitObstacle ){
        console.log( "Hit!" );
    }

}

function move(){
    console.log("Player Position is \n{ ", player.body.position.x, ", ", player.body.position.y, " }");
    game.camera.follow();
    game.physics.arcade.moveToPointer( player, 500 );
    //console.log("You tapped \n{ ", game.input.x, ", ", game.input.y, " }");
    if ( player.body.position.x == game.input.activePointer.screenX ) {//&& player.body.position.y == game.input.pointer.y ){
        player.body.velocity.x = 0;
        player.body.velocity.y = 0;
        console.log("Reset!");
    }
}

/*//Player Constants
PLAYER_HEALTH = 100;
PLAYER_ENERGY = 0;
PLAYER_SPEED = 50;

Player = function( characterSelected ) {
    this.health = PLAYER_HEALTH;
    this.energy = PLAYER_ENERGY;
    this.speed = PLAYER_SPEED;
    this.sprite = "./assets/ball.png";
    game.physics.arcade.enable( this );
    this.inputEnabled = true;
    //this.body.collideWorldBounds = true;
};

Player.prototype.constructor = Player;

Player.prototype.move = function (){
    game.camera.follow();
    game.physics.arcade.moveToPointer( this, 500 );
};

Enemy = function( enemyType ) {
    this.health = PLAYER_HEALTH / 2; 
};

Enemy.prototype.constructor = Enemy;

Wall = function( xPosition, yPosition ){
    this.x = xPosition;
    this.y = yPosition;
    this.spriteSrc = "./assets/dude.png";
};

Wall.prototype.constructor = Wall;

//Room Constants
ROOM_WIDTH = 800;
ROOM_LENGTH = 800;

Room = function( isBossRoom ) {
    this.dimensions = {
        x: ROOM_WIDTH,
        y: ROOM_LENGTH
    };
    this.hasEnemies = true;
    this.isLocked = false;
    this.hasTreasure = false;
    this.isBossRoom = isBossRoom;
};

Room.prototype.constructor = Room;

Collectable = function( collectType ) {
    this.position = {
        x: null,
        y: null
    };
    this.collectType = collectType;    
};

Collectable.prototype.constructor = Collectable;
*/
    </script>
</body>
</html>